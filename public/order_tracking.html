<!doctype html>
<html lang="vi">

<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Theo d√µi ƒë∆°n h√†ng - SHOPPY</title>
    <link rel="icon" type="image/png" href="images/logo/logo1.png">
    <link rel="stylesheet" href="css/product-detail.css">
    <link rel="stylesheet" href="css/order_tracking.css">
    <style>
        /* Th√™m CSS cho loading v√† notification */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #00aaff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <header class="navbar">
        <div class="navbar-top">
            <div class="nav-links-left">
                <a href="seller.html" class="auth-link" id="seller-link">K√™nh Ng∆∞·ªùi B√°n</a>
                <span>|</span>
                <a href="cooperate.html" class="auth-link" id="seller-link">H·ª£p t√°c v·ªõi ch√∫ng t√¥i</a>
            </div>
            <div class="nav-links-right" style="display: flex; align-items: center; gap: 12px;">
                <a href="support.html" class="auth-link" id="support-link"
                    style="display: flex; align-items: center; gap: 4px;">
                    <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 0 24 24" width="18px"
                        fill="#FFFFFF">
                        <path d="M0 0h24v24H0z" fill="none" />
                        <path
                            d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z" />
                    </svg>
                    H·ªó Tr·ª£
                </a>
                <a href="#" class="auth-link" id="account-link">T√†i Kho·∫£n</a>
                <div id="logout-link" title="ƒêƒÉng Xu·∫•t" style="margin-left: 8px; cursor: pointer; display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 -960 960 960" width="18px"
                        fill="#FFFFFF">
                        <path
                            d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-240-56-56 94-94H440v-80h238l-94-94 56-56 200 200-200 200Z" />
                    </svg>
                </div>
            </div>
        </div>
        <div class="navbar-main">
            <div class="nav-left">
                <a href="index.html" class="brand-link">
                    <img src="images/logo/logo1.png" alt="Logo" class="brand-logo">
                    <div class="brand">SHOPPY</div>
                </a>
            </div>
            <div class="nav-center-search">
                <h2 style="color: white; font-size: 24px;">Theo D√µi ƒê∆°n H√†ng C·ªßa B·∫°n</h2>
            </div>
            </div>
    </header>

    <nav class="breadcrumb">
        <a href="index.html">Trang ch·ªß</a> /
        <span>Theo d√µi ƒë∆°n h√†ng</span>
    </nav>

    <main class="order-tracking-container">
        <h1 class="page-title">üì¶ Theo d√µi ƒë∆°n h√†ng c·ªßa b·∫°n</h1>

        <div class="order-filter-controls">
            <div class="toggle-switch">
                <input type="checkbox" id="toggle-completed-orders" checked>
                <label for="toggle-completed-orders" class="toggle-label">
                    <span class="toggle-switch-inner"></span>
                    <span class="toggle-switch-switch"></span>
                    <span class="toggle-label-text">Hi·ªÉn th·ªã ƒë∆°n h√†ng ƒë√£ ho√†n th√†nh</span>
                </label>
            </div>
        </div>

        <div id="loading-state" class="loading-state">
            <div class="spinner"></div>
            <p>ƒêang t·∫£i th√¥ng tin ƒë∆°n h√†ng...</p>
        </div>

        <div id="orders-list" class="orders-list" style="display: none;"></div>

        <div id="empty-state" class="empty-state" style="display: none;">
            <div class="empty-icon">üõí</div>
            <h3>Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</h3>
            <p>H√£y mua s·∫Øm v√† quay l·∫°i ƒë·ªÉ theo d√µi ƒë∆°n h√†ng c·ªßa b·∫°n!</p>
            <a href="index.html" class="btn-primary" style="margin-top: 20px; display: inline-block;">Mua s·∫Øm ngay</a>
        </div>
    </main>

    <div id="edit-review-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>ƒê√°nh gi√° s·∫£n ph·∫©m</h3>
                <button class="close-btn" onclick="closeEditReviewModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="star-rating-input" id="edit-rating-stars">
                    <input type="radio" id="edit-star5" name="edit-rating" value="5">
                    <label for="edit-star5" title="5 sao">‚òÖ</label>
                    <input type="radio" id="edit-star4" name="edit-rating" value="4">
                    <label for="edit-star4" title="4 sao">‚òÖ</label>
                    <input type="radio" id="edit-star3" name="edit-rating" value="3">
                    <label for="edit-star3" title="3 sao">‚òÖ</label>
                    <input type="radio" id="edit-star2" name="edit-rating" value="2">
                    <label for="edit-star2" title="2 sao">‚òÖ</label>
                    <input type="radio" id="edit-star1" name="edit-rating" value="1">
                    <label for="edit-star1" title="1 sao">‚òÖ</label>
                </div>
                <textarea id="edit-review-comment" placeholder="Nh·∫≠p n·ªôi dung ƒë√°nh gi√°..." rows="4"></textarea>
            </div>
            <div class="modal-footer">
                <input type="hidden" id="current-review-item" value="">
                <button class="btn-secondary" onclick="closeEditReviewModal()">H·ªßy</button>
                <button class="btn-primary" onclick="submitOrderReview()">G·ª≠i ƒë√°nh gi√°</button>
            </div>
        </div>
    </div>

    <div id="confirmation-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header" style="border-bottom: none;">
                <h3 id="confirm-modal-title">X√°c nh·∫≠n</h3>
                <button class="close-btn" onclick="hideConfirmationModal()">√ó</button>
            </div>
            <div class="modal-body" style="padding-top: 0;">
                <p id="confirm-modal-message">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y kh√¥ng?</p>
            </div>
            <div class="modal-footer">
                <button id="confirm-cancel-btn" class="btn-secondary" onclick="handleConfirmation(false)">H·ªßy</button>
                <button id="confirm-ok-btn" class="btn-primary" onclick="handleConfirmation(true)">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer">
            <div class="footer-section">
                <div class="footer-logo">
                    <h2 style="color:#00aaff; font-size:28px;">SHOPPY</h2>
                    <p style="color:#ccc;">Web b√°n h√†ng h√†ng ƒë·∫ßu Vi·ªát Nam.</p>
                </div>
                <h3>ƒê·ªëi t√°c thanh to√°n</h3>
                <div class="partners">
                    <img src="images/payment/visa.png" alt="Visa">
                    <img src="images/payment/mastercard.png" alt="Mastercard">
                    <img src="images/payment/momo.png" alt="MoMo">
                    <img src="images/payment/vnpay.jpg" alt="VNPay">
                    <img src="images/payment/vietqr.png" alt="VietQR">
                    <img src="images/payment/mbbank.png" alt="MB Bank">
                    <img src="images/payment/viettinbank.png" alt="Viettinbank">
                </div>
            </div>

            <div class="footer-section">
                <h3>V·ªÅ Shoppy</h3>
                <ul>
                    <li><a href="about.html" class="auth-link" id="support-link">Gi·ªõi thi·ªáu</a></li>
                    <li><a href="contact.html" class="auth-link" id="support-link">Li√™n h·ªá</a></li>
                    <li><a href="support.html" class="auth-link" id="support-link">H·ªó tr·ª£</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>S·∫£n ph·∫©m</h3>
                <ul>
                    <li><a href="#" onclick="return false;" style="cursor: default; opacity: 0.8;">ƒê·∫∑c s·∫£n & Qu√†
                            t·∫∑ng</a></li>
                    <li><a href="#" onclick="return false;" style="cursor: default; opacity: 0.8;">·∫®m th·ª±c ƒê·∫∑c tr∆∞ng</a>
                    </li>
                    <li><a href="#" onclick="return false;" style="cursor: default; opacity: 0.8;">Th·ªùi trang Truy·ªÅn
                            th·ªëng</a></li>
                    <li><a href="#" onclick="return false;" style="cursor: default; opacity: 0.8;">Th·ªß c√¥ng M·ªπ ngh·ªá</a>
                    </li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>Ch√≠nh s√°ch</h3>
                <ul>
                    <li><a href="privacy.html">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
                    <li><a href="terms.html">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                    <li><a href="return-policy.html">ƒê·ªïi tr·∫£ & Ho√†n ti·ªÅn</a></li>
                </ul>


                <h3 style="margin-top:20px;">Theo d√µi ch√∫ng t√¥i</h3>
                <div class="social-icons">
                    <a href="https://www.facebook.com/profile.php?id=61584797843680" target="_blank">
                        <img src="/images/icons/fb.jpg" alt="Facebook">
                    </a>
                    <a href="https://www.tiktok.com/@shoppy006?lang=vi-VN" target="_blank">
                        <img src="/images/icons/tiktok.jpg" alt="TikTok">
                    </a>
                    <a href="http://www.youtube.com/@SHOPPY_Contact" target="_blank">
                        <img src="/images/icons/youtube.png" alt="YouTube">
                    </a>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            @ 2025 Shoppy ‚Äî Khoa CNTT, HCMUS
        </div>
    </footer>

    <div id="full-page-loading" style="
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            flex-direction: column;
            gap: 20px;
        ">
        <div class="spinner"></div>
        <p style="color: #333; font-size: 16px;">ƒêang x·ª≠ l√Ω...</p>
    </div>

    <div id="debug-panel" style="
            position: fixed;
            bottom: 50px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 9998;
            font-size: 12px;
            max-width: 300px;
            display: none;
        ">
        <h4 style="margin: 0 0 5px 0;">Debug Info</h4>
        <div id="debug-content"></div>
    </div>

    <script src="js/supabase-init.js"></script>
    <script src="js/order_tracking.js"></script>

    <script>
        // Th√™m debug helper
        window.debugOrderTracking = function () {
            console.clear();
            console.log('=== ORDER TRACKING DEBUG ===');
            console.log('Window.supabase:', window.supabase);
            supabase.auth.getUser().then(console.log);
            supabase.from('orders').select('*').limit(5).then(console.log);

            const debugPanel = document.getElementById('debug-panel');
            const debugContent = document.getElementById('debug-content');
            if (debugPanel && debugContent) {
                debugContent.innerHTML = `
                    <div>User: ${window.currentUser?.id || 'Not logged in'}</div>
                    <div>Orders loaded: ${window.allOrders?.length || 0}</div>
                    <div>Show completed: ${window.showCompletedOrders}</div>
                `;
                debugPanel.style.display = 'block';
                setTimeout(() => debugPanel.style.display = 'none', 5000);
            }

            // ƒê√É THAY alert() B·∫∞NG showNotification()
            window.showNotification('Th√¥ng tin Debug ƒë√£ ƒë∆∞·ª£c ghi v√†o Console (F12)', '‚ÑπÔ∏è');
        };

    </script>
</body>

</html>