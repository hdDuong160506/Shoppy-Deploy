<!DOCTYPE html>
<html lang="vi">

<head>
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Shoppy</title>
	<link rel="icon" type="image/png" href="images/logo/logo1.png">
	<script src="js/gps-fast.js" async></script>

	<link rel="stylesheet" href="css/style.css">

</head>

<body>
	<header class="navbar">
		<div class="navbar-top">
			<div class="nav-links-left">
				<a href="seller.html" class="auth-link" id="seller-link">Kรชnh Ngฦฐแปi Bรกn</a>
				<span>|</span>
				<a href="#">Trแป thรnh Ngฦฐแปi bรกn Shoppy</a>
			</div>
			<div class="nav-links-right" style="display: flex; align-items: center; gap: 12px;">
				<a href="support.html" class="auth-link" id="support-link">โ Hแป Trแปฃ</a>

				<a href="account.html" class="auth-link" id="account-link">Tรi Khoแบฃn</a>

				<div id="logout-link" title="ฤฤng Xuแบฅt" style="margin-left: 8px; cursor: pointer; display: none;"
					onclick="handleLogout()">
					<svg xmlns="http://www.w3.org/2000/svg" height="18px" viewBox="0 -960 960 960" width="18px"
						fill="#FFFFFF">
						<path
							d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-240-56-56 94-94H440v-80h238l-94-94 56-56 200 200-200 200Z" />
					</svg>
				</div>
			</div>
		</div>

		<div class="navbar-main">
			<div class="nav-left">
				<a href="index.html" class="brand-link">
					<img src="images/logo/logo1.png" alt="Logo" class="brand-logo">
					<div class="brand">SHOPPY</div>
				</a>
			</div>

			<div class="nav-center-search">
				<form id="search_form" onsubmit="event.preventDefault();">

					<input type="text" name="search" id="search_input" placeholder="Tรฌm kiแบฟm trรชn Shoppy..."
						autocomplete="off" />

					<div class="search-actions-right">
						<button type="button" onclick="openImageSearch()" class="icon-btn" title="Tรฌm bแบฑng hรฌnh แบฃnh">
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#5f6368">
								<path
									d="M200-200h560q33 0 56.5-23.5T840-280v-480q0-33-23.5-56.5T760-840H200q-33 0-56.5 23.5T120-760v480q0 33 23.5 56.5T200-200Zm0-80v-480h560v480H200Zm40-80 140-180 100 120 160-200 160 240H240Zm-40 80h560-560Z" />
							</svg>
						</button>

						<button type="button" onclick="startVoiceSearch()" class="icon-btn" title="Tรฌm bแบฑng giแปng nรณi">
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#5f6368">
								<path
									d="M480-400q-50 0-85-35t-35-85v-240q0-50 35-85t85-35q50 0 85 35t35 85v240q0 50-35 85t-85 35Zm0-240Zm-40 520v-123q-104-14-172-93t-68-184h80q0 83 58.5 141.5T480-320q83 0 141.5-58.5T680-520h80q0 105-68 184t-172 93v123h-80Zm40-360q17 0 28.5-11.5T520-520v-240q0-17-11.5-28.5T480-800q-17 0-28.5 11.5T440-760v240q0 17 11.5 28.5T480-480Z" />
							</svg>
						</button>

						<button type="submit" class="icon-btn search-submit" title="Tรฌm kiแบฟm">
							<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
								fill="#1867f8">
								<path
									d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z" />
							</svg>
						</button>
					</div>
				</form>
				<div id="search_suggestions"></div>
			</div>

			<div class="nav-right">
				<button class="cart-btn-icon" id="open-cart">
					<svg xmlns="http://www.w3.org/2000/svg" height="26px" viewBox="0 -960 960 960" width="26px"
						fill="white">
						<path
							d="M280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM246-720l96 200h280l110-200H246Zm-38-80h590q23 0 35 20.5t1 41.5L692-482q-11 20-29.5 31T622-440H324l-44 80h480v80H280q-45 0-68-39.5t-2-78.5l54-98-144-304H40v-80h130l38 80Zm134 280h280-280Z" />
					</svg>
					<span class="cart-count-bubble" id="cart-count" style="display: none;">0</span>
				</button>
			</div>
		</div>
	</header>

	<main>
		<section>
			<div style="width:100%; text-align:center; margin:20px 0; position: relative;">
				<img src="images/banner.jpg" alt="Banner quแบฃng cรกo"
					style="width:95%; max-height:300px; object-fit:cover; border-radius:16px; box-shadow:0 2px 6px rgba(0,0,0,0.15); filter: blur(2px); opacity: 0.5;" />
				<h1
					style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #fff; font-size: 50px; font-weight: 700; text-shadow: 2px 2px 8px rgba(0,0,0,0.6); white-space: nowrap;">
					๐ Web mua hรng dแบซn ฤแบงu, mแปt chแบกm lร mua ๐
				</h1>
			</div>

			<section class="why-choose">
				<h2>Lรฝ do nรชn chแปn mua hรng tแบกi SHOPPY?</h2>
				<div class="reasons">
					<div class="reason-card">
						<img src="images/icons/icon1.jpg" alt="ฤa dแบกng sแบฃn phแบฉm">
						<h4>ฤa dแบกng sแบฃn phแบฉm</h4>
						<p>Tแปซ vฤn phรฒng phแบฉm, quแบงn รกo ฤแบฟn phแปฅ kiแปn โ tแบฅt cแบฃ ฤแปu cรณ tแบกi Shoppy vแปi giรก tแปt nhแบฅt.</p>
					</div>
					<div class="reason-card">
						<img src="images/icons/icon2.jpg" alt="Giao hรng linh hoแบกt">
						<h4>Giao hรng linh hoแบกt</h4>
						<p>Chรบng tรดi hแป trแปฃ ฤแปi trแบฃ miแปn phรญ vร giao hรng tแบญn nฦกi nhanh chรณng, tiแปn lแปฃi.</p>
					</div>
					<div class="reason-card">
						<img src="images/icons/icon3.png" alt="Thanh toรกn an toรn">
						<h4>Thanh toรกn an toรn</h4>
						<p>Thanh toรกn qua nhiแปu phฦฐฦกng thแปฉc: tiแปn mแบทt, thแบป ngรขn hรng, vรญ ฤiแปn tแปญ, ฤแบฃm bแบฃo bแบฃo mแบญt.
						</p>
					</div>
				</div>
			</section>

			<div style="background:#f7f7f7;padding:20px 0;margin:40px 0;text-align:center;border-radius:12px;">
				<div style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
					<div
						style="margin-bottom: 20px; text-align: left; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,0.05);">
						<label for="search_address_input"
							style="font-weight: 600; display: block; margin-bottom: 5px; color: #333;">
							๐ ฤแปa chแป cแปงa bแบกn (Sแปญ dแปฅng ฤแป tรญnh khoแบฃng cรกch):
						</label>
						<div class="address-input-wrapper">
							<input type="text" id="search_address_input"
								placeholder="Vรญ dแปฅ: Hร Nแปi, TP. Hแป Chรญ Minh (แบคn Enter ฤแป tรฌm sแบฃn phแบฉm)"
								style="width: 100%; padding: 10px 40px 10px 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box;">
							<button type="button" class="location-dropdown-btn" id="location-dropdown-btn"
								title="Chแปn ฤแปa ฤiแปm">
								<svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960"
									width="20px" fill="#666">
									<path d="M480-344 240-584l56-56 184 184 184-184 56 56-240 240Z" />
								</svg>
							</button>
							<div class="location-dropdown-menu" id="location-dropdown-menu">
								<div class="location-dropdown-header">๐ Chแปn ฤแปa ฤiแปm</div>
								<div class="location-list" id="location-list">
									<div class="location-item" data-location="Hร Nแปi">๐ Hร Nแปi</div>
									<div class="location-item" data-location="TP. Hแป Chรญ Minh">๐ TP. Hแป Chรญ Minh</div>
									<div class="location-item" data-location="ฤร Nแบตng">๐ ฤร Nแบตng</div>
									<div class="location-item" data-location="Hแบฃi Phรฒng">๐ Hแบฃi Phรฒng</div>
									<div class="location-item" data-location="Cแบงn Thฦก">๐ Cแบงn Thฦก</div>
									<div class="location-item" data-location="Biรชn Hรฒa">๐ Biรชn Hรฒa</div>
									<div class="location-item" data-location="Nha Trang">๐ Nha Trang</div>
									<div class="location-item" data-location="Huแบฟ">๐ Huแบฟ</div>
									<div class="location-item" data-location="Vลฉng Tรu">๐ Vลฉng Tรu</div>
									<div class="location-item" data-location="Buรดn Ma Thuแปt">๐ Buรดn Ma Thuแปt</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Nรบt gแปฃi รฝ theo GPS -->
					<div style="margin-bottom: 20px; text-align: center;">
						<button id="suggest-by-gps-btn"
							style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s, box-shadow 0.2s;"
							onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(0,0,0,0.15)';"
							onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.1)';">
							๐ Gแปฃi รฝ sแบฃn phแบฉm theo vแป trรญ GPS cแปงa bแบกn
						</button>
					</div>

					<section class="suggested-products-section" style="padding:20px 0;">
						<h2 id="suggested-products-title" 
							class="suggested-title"
							data-default-text="๐๏ธ Sแบฃn phแบฉm gแปฃi รฝ cho bแบกn"
							style="text-align:center; margin-bottom:30px; color:#333;">
							๐๏ธ Sแบฃn phแบฉm gแปฃi รฝ cho bแบกn
						</h2>
						<h2 id="search-results-title"
							style="text-align:center; margin-bottom:30px; color:#333; display:none;">
						</h2>
						<div class="products" id="suggested-products-list"
							style="display:grid; grid-template-columns:repeat(auto-fill, minmax(250px, 1fr)); gap:20px; max-width:1200px; margin:0 auto;">
						</div>
					</section>

					<div class="products" id="product-list"></div>
				</div>
		</section>
	</main>

	<div id="cart-popup">
		<h3 style="margin-top:0;">๐ Giแป hรng cแปงa bแบกn</h3>
		<div class="cart-list" id="cart-list">
			<div style="color:#888">Giแป hรng trแปng</div>
		</div>
		<div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
			<div>Tแปng:</div>
			<div style="font-weight:700" id="cart-total">0โซ</div>
		</div>
		<div style="margin-top:12px;display:flex;gap:8px">
			<button class="cart-btn" id="checkout">Xem Giแป hรng</button>
			<button class="small-btn" id="close-cart" style="margin-left:auto;">ฤรณng</button>
		</div>
	</div>

	<footer>
		<div class="footer">
			<div class="footer-section">
				<div class="footer-logo">
					<h2 style="color:#00aaff; font-size:28px;">SHOPPY</h2>
					<p style="color:#ccc;">Web bรกn hรng hรng ฤแบงu Viแปt Nam.</p>
				</div>
				<h3>ฤแปi tรกc thanh toรกn</h3>
				<div class="partners">
					<img src="images/payment/visa.png" alt="Visa">
					<img src="images/payment/mastercard.png" alt="Mastercard">
					<img src="images/payment/momo.png" alt="MoMo">
					<img src="images/payment/vnpay.jpg" alt="VNPay">
					<img src="images/payment/vietqr.png" alt="VietQR">
					<img src="images/payment/mbbank.png" alt="MB Bank">
					<img src="images/payment/viettinbank.png" alt="Viettinbank">
				</div>
			</div>

			<div class="footer-section">
				<h3>Vแป Shoppy</h3>
				<ul>
					<li><a href="about.html" class="auth-link" id="support-link">Giแปi thiแปu</a></li>
					<li><a href="contact.html" class="auth-link" id="support-link">Liรชn hแป</a></li>
					<li><a href="#">Trแปฃ giรบp</a></li>
				</ul>
			</div>

			<div class="footer-section">
				<h3>Sแบฃn phแบฉm</h3>
				<ul>
					<li><a href="#">Cรกc sแบฃn phแบฉm ฤแบทc trฦฐng</a></li>
					<li><a href="#">ฤแป ฤiแปn tแปญ</a></li>
					<li><a href="#">Thแปi trang</a></li>
					<li><a href="#">ฤแป gia dแปฅng</a></li>
				</ul>
			</div>

			<div class="footer-section">
				<h3>Chรญnh sรกch</h3>
				<ul>
					<li><a href="#">Chรญnh sรกch bแบฃo mแบญt</a></li>
					<li><a href="#">ฤiแปu khoแบฃn sแปญ dแปฅng</a></li>
					<li><a href="#">ฤแปi trแบฃ & Hoรn tiแปn</a></li>
				</ul>

				<h3 style="margin-top:20px;">Theo dรตi chรบng tรดi</h3>
				<div class="social-icons">
					<a href="https://www.facebook.com/profile.php?id=61584797843680" target="_blank">
						<img src="/images/icons/fb.jpg" alt="Facebook">
					</a>
					<a href="https://www.tiktok.com/@shoppy006?lang=vi-VN" target="_blank">
						<img src="/images/icons/tiktok.jpg" alt="TikTok">
					</a>
					<a href="http://www.youtube.com/@SHOPPY_Contact" target="_blank">
						<img src="/images/icons/youtube.png" alt="YouTube">
					</a>
				</div>
			</div>
		</div>

		<div class="footer-bottom">
			@ 2025 Shoppy โ Khoa CNTT, HCMUS
		</div>
	</footer>

	<div id="image_search_popup" class="modal-overlay">
		<div class="image-search-modal">
			<div class="modal-header">
				<h3>Tรฌm kiแบฟm bแบฑng hรฌnh แบฃnh</h3>
				<button class="close-btn" onclick="closeImageSearch()">ร</button>
			</div>

			<div class="image-tabs">
				<button class="tab-button active" data-tab="upload" onclick="switchImageTab('upload')">
					<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
						<path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z" />
					</svg>
					Upload แบขnh
				</button>
				<button class="tab-button" data-tab="paste" onclick="switchImageTab('paste')">
					<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
						<path
							d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z" />
					</svg>
					Dรกn URL/Base64
				</button>
			</div>

			<div class="tab-contents">
				<div id="upload-tab" class="tab-panel active">
					<div class="upload-zone" id="imageUploadArea">
						<div class="upload-icon">๐</div>
						<p class="upload-text">Kรฉo thแบฃ แบฃnh vรo ฤรขy</p>
						<p class="upload-subtext">hoแบทc</p>
						<button type="button" class="browse-btn" id="browseBtn">
							Chแปn File
						</button>
						<input type="file" id="imageFileInput" accept="image/*" style="display: none;">
						<p class="upload-hint">Hแป trแปฃ: JPG, PNG, GIF (Tแปi ฤa 5MB)</p>
					</div>

					<div id="uploadPreviewContainer" class="preview-container" style="display: none;">
						<img id="imagePreview" alt="Preview">
						<button class="remove-image-btn" onclick="clearUploadImage()">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path
									d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
							</svg>
							Xรณa แบฃnh
						</button>
					</div>
				</div>

				<div id="paste-tab" class="tab-panel">
					<div class="paste-zone">
						<textarea id="imagePasteInput"
							placeholder="Dรกn URL แบฃnh hoแบทc Base64 string แป ฤรขy...&#10;&#10;Vรญ dแปฅ:&#10;โข https://example.com/image.jpg&#10;โข data:image/png;base64,iVBORw0T..."></textarea>
					</div>

					<div id="pastePreviewContainer" class="preview-container" style="display: none;">
						<img id="pastePreview" alt="Paste Preview">
						<button class="remove-image-btn" onclick="clearPasteImage()">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path
									d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
							</svg>
							Xรณa แบฃnh
						</button>
					</div>
				</div>
			</div>

			<div id="imageSearchError" class="error-message"></div>

			<div class="modal-footer">
				<button type="button" class="btn-secondary" onclick="closeImageSearch()">
					Hแปงy
				</button>
				<button type="button" class="btn-primary" onclick="searchWithImage()">
					<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
						<path
							d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" />
					</svg>
					Tรฌm Kiแบฟm
				</button>
			</div>
		</div>
	</div>

	<div id="voice_popup" style="display:none;">
		<div class="voice-popup-content">
			<h5>๐๏ธ ฤang nghe...</h5>
			<p>Hรฃy nรณi tแปซ khรณa tรฌm kiแบฟm cแปงa bแบกn</p>
			<p id="transcript_display" style="min-height: 25px; color: #1867f8; font-weight: bold; margin: 15px 0;"></p>
			<div class="listening-dot">โข</div>
			<button type="button" onclick="cancelVoiceSearch()"
				style="padding:10px 20px; background:#666; color:white; border:none; border-radius:8px; cursor:pointer; margin-top:10px;">
				Hแปงy
			</button>
		</div>
	</div>

	<div class="custom-modal-overlay" id="custom-confirm-modal" style="
            /* CSS TแปI THIแปU ฤแป modal hoแบกt ฤแปng ฤรบng */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0, 0, 0, 0.6); display: none; justify-content: center; 
            align-items: center; z-index: 9000;
        ">
		<div class="custom-modal-content" style="
                background: white; padding: 30px; border-radius: 10px; width: 90%; 
                max-width: 400px; text-align: center; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            ">
			<h3 id="modal-title" style="color: #0b38cc; margin-top: 0; margin-bottom: 15px;">Xรกc nhแบญn</h3>
			<p id="modal-message" style="margin-top: 0; margin-bottom: 25px; font-size: 16px; line-height: 1.5;">
				Bแบกn cรณ chแบฏc chแบฏn muแปn thแปฑc hiแปn hรnh ฤแปng nรy khรดng?</p>
			<div class="modal-actions" style="display: flex; justify-content: space-around; gap: 15px;">
				<button id="modal-confirm-no"
					style="width: 45%; padding: 10px; border-radius: 25px; font-size: 14px; text-transform: none; background-color: #ccc; border: 1px solid #ccc; color: #333; cursor: pointer;">Hแปงy</button>
				<button id="modal-confirm-yes"
					style="width: 45%; padding: 10px; border-radius: 25px; font-size: 14px; text-transform: none; background-color: #0b38cc; border: 1px solid #0b38cc; color: white; cursor: pointer;">ฤแปng
					รฝ</button>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
	<script src="js/supabase-init.js"></script>
	<script src="js/index.js"></script>
	<div id="full-page-loading" style="
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(255, 255, 255, 0.85); display: none; 
            justify-content: center; align-items: center; z-index: 10000;
        ">
		<div class="spinner"></div>
	</div>
</body>

</html>